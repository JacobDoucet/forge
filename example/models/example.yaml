# Example Forge Model Specification
# This is a complete example demonstrating Forge's code generation capabilities.

# Define enums for status values
enums:
  - name: TaskStatus
    type: string
    values:
      - pending
      - in_progress
      - completed
      - cancelled

  - name: TaskPriority
    type: string
    values:
      - low
      - medium
      - high
      - urgent

# Define your data objects
objects:
  # A simple Task object with MongoDB collection and HTTP endpoints
  - name: Task
    fields:
      - name: title
        type: string
        required: true
      - name: description
        type: string
      - name: status
        type: TaskStatus
        required: true
      - name: priority
        type: TaskPriority
      - name: dueDate
        type: timestamp
      - name: tags
        type: List<string>
      - name: assigneeId
        type: string
      - name: comments
        type: List<TaskComment>

    # MongoDB collection configuration
    collection:
      - type: mongo
        name: tasks

    # Define indexes for efficient queries
    indexes:
      - name: status_idx
        fields:
          - name: status
      - name: assignee_status_idx
        fields:
          - name: assigneeId
          - name: status

    # HTTP endpoint configuration
    http:
      endpoint: tasks
      methods:
        - GET
        - POST
        - PUT
        - DELETE

    # Permission configuration (RBAC)
    permissions:
      read:
        - rbac: admin
        - rbac: user
        - rbac: guest
      write:
        - rbac: admin
        - rbac: user

  # A nested object (no collection - used as an embedded type)
  - name: TaskComment
    fields:
      - name: text
        type: string
        required: true
      - name: authorId
        type: string
        required: true
      - name: createdAt
        type: timestamp

  # Example of an object with references
  - name: Project
    fields:
      - name: name
        type: string
        required: true
      - name: description
        type: string
      - name: ownerId
        type: string
        required: true

    collection:
      - type: mongo
        name: projects

    http:
      endpoint: projects
      methods:
        - GET
        - POST
        - PUT
        - DELETE

    permissions:
      read:
        - rbac: admin
        - rbac: user
        - rbac: guest
      write:
        - rbac: admin

# Define custom errors
errors:
  - name: TaskNotFound
    code: TASK_NOT_FOUND
    message: "The requested task was not found"
  - name: InvalidTaskStatus
    code: INVALID_TASK_STATUS
    message: "The provided task status is invalid"
  - name: ProjectNotFound
    code: PROJECT_NOT_FOUND
    message: "The requested project was not found"

# Define event types for real-time updates
events:
  - TaskCreated
  - TaskUpdated
  - TaskDeleted
  - TaskStatusChanged
  - ProjectCreated
  - ProjectUpdated

# Global permissions definition
permissions:
  rbac:
    - name: admin
    - name: user
    - name: guest
