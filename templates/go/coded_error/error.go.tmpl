type Code string
const (
    {{- range ListErrors }}
    Code{{ .Name }} Code = "{{ .Code }}"
    {{- end }}
)

type customError struct {
	errorCode  Code
	httpStatus int
	message    string
}

// Error implements the error interface.
func (e *customError) Error() string {
	return fmt.Sprintf("errorCode=%s, httpStatus=%d, message=%s", e.errorCode, e.httpStatus, e.message)
}

func newCustomError(errorCode Code, httpStatus int, message string) error {
	return &customError{
		errorCode:  errorCode,
		httpStatus: httpStatus,
		message:    message,
	}
}

// ResolveHTTPStatus extracts the HTTP status from an error, even if it's wrapped.
func ResolveHTTPStatus(err error) int {
	var customErr *customError
	if errors.As(err, &customErr) {
		return customErr.httpStatus
	}
	return 500
}

// ResolveErrorCode extracts the error code from an error, even if it's wrapped.
func ResolveErrorCode(err error) Code {
    if err == nil {
        return ""
    }
	var customErr *customError
	if errors.As(err, &customErr) {
		return customErr.errorCode
	}
	return CodeUnexpected
}

func ResolveErrorCodeAsString(err error) string {
    return string(ResolveErrorCode(err))
}

{{ range ListErrors }}
func New{{ .Name }}Error(message... string) error {
    msg := "{{ .Message }}"
    if len(message) > 0 {
        msg = msg + ": " + strings.Join(message, ". ")
    }
    return newCustomError(Code{{ .Name }}, {{ .HttpStatus }}, msg)
}
{{ end }}
